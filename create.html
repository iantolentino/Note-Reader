<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Note - Notes</title>
        <link rel="icon" href="assets/logo/logo-n.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="main-container">
    <!-- Navigation -->
    <nav class="navbar">
        <div class="navbar-container">
            <a class="navbar-brand" href="dashboard.html">
            </a>
            
            <button class="navbar-toggle" id="navbarToggle">â˜°</button>
            
            <div class="navbar-nav" id="navbarNav">
                <a href="dashboard.html" class="nav-link">Dashboard</a>
                <a href="upload.html" class="nav-link">Upload</a>
                <a href="#" class="nav-link" onclick="logout()">Logout</a>
            </div>
        </div>
    </nav>

    <main class="content-area">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10 col-lg-8">
                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0">Create New Note</h4>
                        <p class="text-muted mb-0 mt-2">Write your note in Markdown format</p>
                    </div>
                    <div class="card-body">
                        <!-- Title Input -->
                        <div class="form-group">
                            <label for="noteTitle" class="form-label">Note Title</label>
                            <input type="text" class="form-control" id="noteTitle" 
                                   placeholder="Enter a title for your note..." required>
                        </div>
                        
                        <!-- Category Selection -->
                        <div class="form-group">
                            <label for="noteCategory" class="form-label">Category</label>
                            <select class="form-select" id="noteCategory" required>
                                <option value="">Select category</option>
                                <option value="programming">Programming</option>
                                <option value="personal">Personal</option>
                                <option value="work">Work</option>
                                <option value="study">Study</option>
                                <option value="ideas">Ideas</option>
                                <option value="other">Other (custom)</option>
                            </select>
                            
                            <div id="customCategory" class="mt-2" style="display: none;">
                                <label for="customCategoryInput" class="form-label">Custom Category Name</label>
                                <input type="text" class="form-control" id="customCategoryInput" 
                                       placeholder="Enter your custom category name..."
                                       required>
                                <div class="form-text">This will create a new category folder in GitHub</div>
                            </div>
                        </div>
                        
                        <!-- Markdown Editor -->
                        <div class="form-group">
                            <label class="form-label">Note Content</label>
                            <div class="markdown-editor">
                                <div class="markdown-toolbar">
                                    <button type="button" onclick="formatText('**', '**')" title="Bold">B</button>
                                    <button type="button" onclick="formatText('*', '*')" title="Italic">I</button>
                                    <button type="button" onclick="formatText('# ', '')" title="Heading">H</button>
                                    <button type="button" onclick="formatText('- ', '')" title="List">â€¢</button>
                                    <button type="button" onclick="formatText('`', '`')" title="Code">`</button>
                                    <button type="button" onclick="formatText('[', '](url)')" title="Link">ðŸ”—</button>
                                </div>
                                <div class="markdown-content">
                                    <textarea id="markdownInput" class="markdown-input" placeholder="Write your note in Markdown format..."></textarea>
                                    <div id="markdownPreview" class="markdown-preview"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Actions -->
                        <div class="d-flex gap-2">
                            <button type="button" id="createBtn" class="btn btn-primary flex-1" onclick="createNote()">
                                Create Note
                            </button>
                            <a href="dashboard.html" class="btn btn-outline">Cancel</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="assets/js/auth.js"></script>
    <script src="assets/js/config.js"></script>
    <script src="assets/js/renderer.js"></script>
    <script src="assets/js/create.js"></script>
    <script>
        // Mobile navbar toggle
        document.getElementById('navbarToggle').addEventListener('click', function() {
            document.getElementById('navbarNav').classList.toggle('open');
        });
        
        // Category selection handler
        document.getElementById('noteCategory').addEventListener('change', function() {
            const customCategoryDiv = document.getElementById('customCategory');
            if (this.value === 'other') {
                customCategoryDiv.style.display = 'block';
            } else {
                customCategoryDiv.style.display = 'none';
            }
        });
        
        // Markdown preview
        document.getElementById('markdownInput').addEventListener('input', function() {
            document.getElementById('markdownPreview').innerHTML = markdownToHTML(this.value);
        });
        
        // Text formatting helper
        function formatText(before, after) {
            const textarea = document.getElementById('markdownInput');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selectedText = textarea.value.substring(start, end);
            const newText = before + selectedText + after;
            
            textarea.value = textarea.value.substring(0, start) + newText + textarea.value.substring(end);
            textarea.focus();
            textarea.setSelectionRange(start + before.length, end + before.length);
            
            // Update preview
            document.getElementById('markdownPreview').innerHTML = markdownToHTML(textarea.value);
        }
    </script>
</body>
</html>